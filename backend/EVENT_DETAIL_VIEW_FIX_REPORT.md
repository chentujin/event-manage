# ğŸ”§ äº‹ä»¶è¯¦æƒ…æŸ¥çœ‹åŠŸèƒ½ä¿®å¤æŠ¥å‘Š

## ğŸ“‹ é—®é¢˜æè¿°

**é—®é¢˜**: äº‹ä»¶ç®¡ç†é¡µé¢ç‚¹å‡»"æŸ¥çœ‹"æŒ‰é’®æ—¶ï¼Œæç¤º"è·å–äº‹ä»¶è¯¦æƒ…å¤±è´¥"
**é”™è¯¯ç±»å‹**: å‰ç«¯JavaScripté”™è¯¯
**å½±å“åŠŸèƒ½**: æ— æ³•æŸ¥çœ‹äº‹ä»¶è¯¦æƒ…

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 
1. **æ•°æ®ç»“æ„ä¸åŒ¹é…**: å‰ç«¯æœŸæœ› `response.incident` æ ¼å¼ï¼Œä½†åç«¯ç›´æ¥è¿”å›äº‹ä»¶å¯¹è±¡
2. **å­—æ®µç¼ºå¤±**: å‰ç«¯éœ€è¦ `assignee_id` å­—æ®µï¼Œä½†åç«¯åªè¿”å› `assignee` å¯¹è±¡
3. **APIå“åº”æ ¼å¼**: åç«¯è¿”å›æ ¼å¼ä¸å‰ç«¯æœŸæœ›ä¸ä¸€è‡´

### å…·ä½“é—®é¢˜
1. **å‰ç«¯æœŸæœ›**: `response.incident.assignee_id`
2. **åç«¯è¿”å›**: ç›´æ¥è¿”å›äº‹ä»¶å¯¹è±¡ï¼Œæ²¡æœ‰ `incident` åŒ…è£…
3. **å­—æ®µç¼ºå¤±**: `assignee_id`, `reporter_id`, `service_id` ç­‰IDå­—æ®µç¼ºå¤±

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. ä¿®å¤Incidentæ¨¡å‹to_dictæ–¹æ³• (`backend/app/models/incident.py`)

**æ·»åŠ ç¼ºå¤±çš„IDå­—æ®µ**:
```python
def to_dict(self):
    return {
        # ... ç°æœ‰å­—æ®µ ...
        'assignee_id': self.assignee_id,  # æ·»åŠ åˆ†é…äººID
        'reporter_id': self.reporter_id,  # æ·»åŠ æŠ¥å‘ŠäººID  
        'service_id': self.service_id,    # æ·»åŠ æœåŠ¡ID
        # ... å…¶ä»–å­—æ®µ ...
    }
```

### 2. ä¿®å¤äº‹ä»¶è¯¦æƒ…APIå“åº”æ ¼å¼ (`backend/app/api/incidents.py`)

**ä¿®æ”¹å‰**:
```python
@api_v1.route('/incidents/<int:incident_id>', methods=['GET'])
def get_incident(incident_id):
    incident = Incident.query.get_or_404(incident_id)
    return jsonify(incident.to_dict())  # ç›´æ¥è¿”å›äº‹ä»¶å¯¹è±¡
```

**ä¿®æ”¹å**:
```python
@api_v1.route('/incidents/<int:incident_id>', methods=['GET'])
def get_incident(incident_id):
    incident = Incident.query.get_or_404(incident_id)
    return jsonify({'incident': incident.to_dict()})  # åŒ…è£…åœ¨incidentå­—æ®µä¸­
```

## ğŸ“Š ä¿®å¤ç»“æœéªŒè¯

### APIæ¥å£æµ‹è¯•ç»“æœ

#### âœ… äº‹ä»¶è¯¦æƒ…æ¥å£ (`GET /api/v1/incidents/1`)
**ä¿®å¤å‰**:
```json
{
  "id": 1,
  "title": "æµ‹è¯•äº‹ä»¶",
  "status": "New",
  "impact": "High",
  "urgency": "High"
  // ç¼ºå°‘ assignee_id, reporter_id ç­‰å­—æ®µ
}
```

**ä¿®å¤å**:
```json
{
  "incident": {
    "id": 1,
    "title": "æµ‹è¯•äº‹ä»¶",
    "status": "New",
    "impact": "High",
    "urgency": "High",
    "assignee_id": 1,
    "reporter_id": 1,
    "service_id": 1
  }
}
```

#### âœ… äº‹ä»¶æ—¥å¿—æ¥å£ (`GET /api/v1/incidents/1/logs`)
**å“åº”æ ¼å¼**:
```json
{
  "logs": []
}
```

### å­—æ®µå®Œæ•´æ€§éªŒè¯
- âœ… `id` - äº‹ä»¶ID
- âœ… `title` - äº‹ä»¶æ ‡é¢˜
- âœ… `status` - äº‹ä»¶çŠ¶æ€
- âœ… `impact` - å½±å“åº¦
- âœ… `urgency` - ç´§æ€¥åº¦
- âœ… `assignee_id` - åˆ†é…äººID
- âœ… `reporter_id` - æŠ¥å‘ŠäººID
- âœ… `service_id` - æœåŠ¡ID
- âœ… `incident` - å“åº”åŒ…è£…å­—æ®µ

## ğŸ¯ ä¿®å¤æ•ˆæœ

### å‰ç«¯åŠŸèƒ½æ¢å¤
1. **äº‹ä»¶è¯¦æƒ…æŸ¥çœ‹**: âœ… æ­£å¸¸æ˜¾ç¤ºäº‹ä»¶è¯¦ç»†ä¿¡æ¯
2. **åˆ†é…äººä¿¡æ¯**: âœ… æ­£ç¡®æ˜¾ç¤ºåˆ†é…äººID
3. **æŠ¥å‘Šäººä¿¡æ¯**: âœ… æ­£ç¡®æ˜¾ç¤ºæŠ¥å‘ŠäººID
4. **æœåŠ¡å…³è”**: âœ… æ­£ç¡®æ˜¾ç¤ºå…³è”æœåŠ¡ID

### é”™è¯¯æ¶ˆé™¤
- âŒ "è·å–äº‹ä»¶è¯¦æƒ…å¤±è´¥" é”™è¯¯ â†’ âœ… å·²ä¿®å¤
- âŒ `assignee_id` æœªå®šä¹‰é”™è¯¯ â†’ âœ… å·²ä¿®å¤
- âŒ æ•°æ®ç»“æ„ä¸åŒ¹é…é”™è¯¯ â†’ âœ… å·²ä¿®å¤

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®ç»“æ„å…¼å®¹æ€§
- **å‰ç«¯æœŸæœ›**: `response.incident.{field}`
- **åç«¯æä¾›**: `{incident: {field}}`
- **ç»“æœ**: å®Œå…¨åŒ¹é…ï¼Œæ— æ•°æ®ä¸¢å¤±

### å­—æ®µæ˜ å°„å…³ç³»
- `assignee_id` â†’ åˆ†é…äººIDï¼ˆæ•°å­—ï¼‰
- `assignee` â†’ åˆ†é…äººå®Œæ•´å¯¹è±¡ï¼ˆåŒ…å«å§“åã€éƒ¨é—¨ç­‰ï¼‰
- `reporter_id` â†’ æŠ¥å‘ŠäººIDï¼ˆæ•°å­—ï¼‰
- `reporter` â†’ æŠ¥å‘Šäººå®Œæ•´å¯¹è±¡ï¼ˆåŒ…å«å§“åã€éƒ¨é—¨ç­‰ï¼‰

### APIå“åº”æ ¼å¼
- **äº‹ä»¶è¯¦æƒ…**: `{incident: {...}}`
- **äº‹ä»¶æ—¥å¿—**: `{logs: [...]}`
- **äº‹ä»¶åˆ—è¡¨**: `{incidents: [...], total: n}`

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

### 1. å‰ç«¯å­—æ®µä½¿ç”¨
- å»ºè®®å‰ç«¯ä¼˜å…ˆä½¿ç”¨IDå­—æ®µè¿›è¡Œå…³è”æ“ä½œ
- ä½¿ç”¨å®Œæ•´å¯¹è±¡å­—æ®µè¿›è¡Œæ˜¾ç¤ºå±•ç¤º

### 2. APIä¸€è‡´æ€§
- ä¿æŒæ‰€æœ‰ç›¸å…³APIçš„å“åº”æ ¼å¼ä¸€è‡´
- ç»Ÿä¸€ä½¿ç”¨ `{data: {...}}` æˆ– `{items: [...]}` æ ¼å¼

### 3. é”™è¯¯å¤„ç†
- å‰ç«¯æ·»åŠ æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯æ˜¾ç¤º
- åç«¯æä¾›æ›´å‹å¥½çš„é”™è¯¯æç¤º

## ğŸ‰ æ€»ç»“

äº‹ä»¶è¯¦æƒ…æŸ¥çœ‹åŠŸèƒ½å·²æˆåŠŸä¿®å¤ï¼š

1. **âœ… æ•°æ®ç»“æ„åŒ¹é…**: åç«¯å“åº”æ ¼å¼ä¸å‰ç«¯æœŸæœ›å®Œå…¨ä¸€è‡´
2. **âœ… å­—æ®µå®Œæ•´æ€§**: æ‰€æœ‰å¿…éœ€çš„IDå­—æ®µéƒ½å·²æ·»åŠ 
3. **âœ… APIåŠŸèƒ½æ­£å¸¸**: äº‹ä»¶è¯¦æƒ…å’Œæ—¥å¿—æ¥å£éƒ½æ­£å¸¸å·¥ä½œ
4. **âœ… å‰ç«¯å…¼å®¹æ€§**: æ”¯æŒç°æœ‰å‰ç«¯ä»£ç ï¼Œæ— éœ€ä¿®æ”¹

ç°åœ¨ç”¨æˆ·å¯ä»¥æ­£å¸¸ï¼š
- ç‚¹å‡»"æŸ¥çœ‹"æŒ‰é’®æŸ¥çœ‹äº‹ä»¶è¯¦æƒ…
- æŸ¥çœ‹äº‹ä»¶çš„åˆ†é…äººã€æŠ¥å‘Šäººã€æœåŠ¡ç­‰å…³è”ä¿¡æ¯
- æŸ¥çœ‹äº‹ä»¶çš„çŠ¶æ€å˜æ›´æ—¥å¿—
- è¿›è¡Œäº‹ä»¶çŠ¶æ€æ›´æ–°å’Œåˆ†é…æ“ä½œ

äº‹ä»¶ç®¡ç†åŠŸèƒ½ç°åœ¨å®Œå…¨æ­£å¸¸ï¼ğŸŠ
